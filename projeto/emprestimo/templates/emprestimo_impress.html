<!DOCTYPE html>
<html charset="UTF-8">
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.19.1/moment.min.js"></script>

{% load widget_tweaks %}

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="robots" content="noindex">
    <style>
		
        body {
            font-family: "Arial";
		}
		
        @media print {
            .no-print,
            .no-print * {
                display: none !important;
            }
		}
		
        .document {
            margin: auto auto;
            width: 216mm;
            height: 108mm;
            background-color: #fff;
        }

        .headerBtn {
            margin: auto auto;
            width: 216mm;
            background-color: #fff;
            display: none;
        }

        table {
            width: 100%;
            position: relative;
            border-collapse: collapse;
        }

        .bankLogo {
            width: 28%;
        }
        .boletoNumber {
            width: 62%;
            font-weight: bold;
        }

        .center {
            text-align: center;
        }
        .testando {
			text-align: center;						
        }

        .right {
            text-align: right;
            right: 20px;
        }

        td {
            position: relative;
        }

        .title {
            position: absolute;
            left: 0px;
            top: 0px;
            font-size: 12px;
			font-weight: bold;						
        }
        .title2 {
            position: absolute;
            left: 0px;
            top: 0px;
            font-size: 13px;
            font-weight: normal;
        }        
        .text {
            font-size: 12px;
		}
		
        p.content {
            padding: 0px;
            width: 100%;
            margin: 0px;
			font-size: 13px;
			margin-top: 2px;
			margin-bottom: 4px;
        }
		p.reducao {
            padding: 0px;
            color:red;
			width: 50%;
			font-size: 3px;
        }
		p.reducao1 {
            padding: 0px;
            color:red;
			width: 50%;
			margin-top: -20px;
			font-size: 1px;
        }

        .sideBorders {
            border-left: 1px solid black;
            border-right: 1px solid black;
        }

        hr {
            size: 1;
            border: 1px dashed;
        }

        br {
            content: " ";
            display: block;
            margin: 12px 0;
            line-height: 12px;
        }
        br2 {
            content: " ";
            display: block;
            margin: 6px 0;
            line-height: 12px;
        }
		span.b {
			display: inline-block;
			width: 100px;
			height: 100px;
			padding: 5px;
			border: 1px solid blue;    
			background-color: yellow; 
		}

        .print {
            /* TODO(dbeam): reconcile this with overlay.css' .default-button. */
            background-color: rgb(77, 144, 254);
            background-image: linear-gradient(to bottom, rgb(77, 144, 254), rgb(71, 135, 237));
            border: 1px solid rgb(48, 121, 237);
            color: #fff;
            text-shadow: 0 1px rgba(0, 0, 0, 0.1);
        }

        .btnDefault {
            font-kerning: none;
            font-weight: bold;
        }

        .btnDefault:not(:focus):not(:disabled) {
            border-color: #808080;
        }

        button {
            border: 1px;
            padding: 5px;
            line-height: 20px;
        }

		.box {
			float: left;
			width: 100px;
			height: 40px;
			margin: 4px;
			border: 1px solid black;
			text-align: center;
		}
		.box2 {
			float: left;
			width: 500px;
			height: 25px;
			margin: 4px;
			text-align: left;		
		}
		.box3 {
			float: left;
			width: 500px;
			height: 25px;
			margin: 2px;				
			text-align: left;	
		}
		.box4 {			
			width: 450px;
			height: 25px;
			margin: 2px;				
			margin-left: 350px;	
			margin-top: 150px;	
			position: absolute;
			text-align: center;
		}
		.box5 {			
			width: 450px;
			height: 25px;
			margin: 2px;			
			margin-left: 350px;	
			margin-top: 180px;	
			position: absolute;
			text-align: center;
		}
		.box6 {			
			width: 813px;
			height: 356px;				
			border: 1px solid black;			
			position:absolute;
			text-align: center;
			border: 1px solid black;
		}
		.space1 {			
			content: " ";
            display: block;            
            line-height: 123px;
		}
		.space2 {			
			content: " ";
            display: block;            
            line-height: 70px;
		}
		.maiusculo {
			text-transform: capitalize;
		}
		.after-box {
			clear: left;
		}    
    </style>        
</head>


<div class="document">
	<div id = "carne" class="col-sm-6">
	
	</div>
</div>
<!-- ----------------------- -->
<script>
	Number.prototype.toFixedDown = function(digits){
		var re = new RegExp("(\\d+\\.\\d{" + digits + "})(\\d)"),
		m = this.toString().match(re);
		return m ? parseFloat(m[1]) : this.valueOf();
	};
	
	window.onload = function imprimir(){
		
		//VARIÁVEIS DA DATA DO EMPRESTIMO
		var contador_meses = 0
		var contador_anos  = 0
		var dataEmprestimo = "{{ object.dt_emprestimo}}"		
		var dia
		var mes
		var ano
		var aux_dia = {{object.dt_emprestimo.day}}
		var aux_mes = {{object.dt_emprestimo.month}}
		var aux_ano = {{object.dt_emprestimo.year}}

		//VARIÁVEIS DO EMPRESTIMO
		var aux_qtd_parccela = {{object.qtd_parcelas}}
		var data_emissao = "{{object.dt_emprestimo|date:"d/m/Y"}}"
		var valor_da_parcela = parseFloat("{{object.valor_prestacao|floatformat:2}}".replace(',', '.'))	
		var valor_multa = parseFloat((valor_da_parcela*0.020)).toFixedDown(2)
		var valor_juros_dia = (valor_da_parcela*0.0066).toFixedDown(2)
		var contador_parcela = 0
		
		//VARIÁVEIS DO CLIENTE
		var cliente_nome = "{{object.cliente}}"
		var cpf = "{{object.cliente.cpf}}"
		var rua = "{{object.cliente.rua}}"
		var bairro = "{{object.cliente.bairro}}"
		var cidade = "{{object.cliente.cidade}}"
		var uf = "{{object.cliente.uf}}"
		var numero_casa = "{{object.cliente.numero_casa}}"
		var cep = "{{object.cliente.cep}}"


		//VARIÁVEIS DO FIADOR
		var fiador        = "{{object.cliente.fiador.nome}}"
    	var cpf_fiador    = "{{object.cliente.fiador.cpf}}"

		var meses = new Array("01", "02", "03", "04", "05", "06" ,"07", "08", "09", "10", "11", "12")
		

		for (var j = 1 ; j <= {{object.qtd_parcelas}}; j++){
			if(j==1){
			carne.innerHTML +=	
				`		
				<div class="box6">			
					
				</div>	
				<div class="box2">			
					Empréstimo em <strong>${"{{object.qtd_parcelas}}"} parcelas</strong> no dia ${dataEmprestimo}<br>&nbsp</br>	
				</div>						
				<div class="box3">			
					<strong>Fique de olho na data de vencimento da sua parcela</strong>
				</div>
				<br2>&nbsp</br2>		
				<br2>&nbsp</br2>		
				<br2>&nbsp</br2>		
				<br2>&nbsp</br2>	
					
				`		
			}	
			contador_meses++
			contador_parcela++

			dia  = aux_dia
			mes  = aux_mes+contador_meses
			ano  = aux_ano

			//AJUSTA A DATA QUANDO O MES É FEVEREIRO 
			if(dia == 1 && mes == 4){
                dia = 30 
                mes = 3
            }
			if(dia == 30 && mes == 2){
				dia = 1 
				mes = 3
			}
			
			//AJUSTA MESES E ANOS 
			if(mes == 13){
				contador_meses = 0
				aux_mes = 1
				mes = 1	
				aux_ano++
				ano++				
			}

			if(j<=3){
			carne.innerHTML +=	
				`		
				<div class="box">			
					${j}º&nbspParcela <strong>${dia}/${meses[mes-1]}/${ano}</strong>			
				</div>		
				`		
			}	
			if(j==3){
			carne.innerHTML +=
			`
				<br2>&nbsp</br2>
				<br2>&nbsp</br2>
				<br2>&nbsp</br2>
				
			`
			}
			if(j==1 && cliente_nome){
			carne.innerHTML +=	
				`		
				<div class="box4 maiusculo">			
					<strong>${cliente_nome}</strong>
				</div>	
				<div class="box5">			
					Segunda a Sexta-feira das 14h às 18h
				</div>	
				
				`		
			}	
			if(j>3 && j<7){
			carne.innerHTML +=	
			`		
				<div class="box">			
					${j}º&nbspParcela <strong>${dia}/${meses[mes-1]}/${ano}</strong>				
				</div>		
			`	
			}
			if(j==6){
			carne.innerHTML +=
			`
				<br2>&nbsp</br2>
				<br2>&nbsp</br2>
				<br2>&nbsp</br2>
			`
			}
			if(j>6 && j<10){		
			carne.innerHTML +=
			`			
				<div class="box">			
					${j}º&nbspParcela <strong>${dia}/${meses[mes-1]}/${ano}</strong>			
				</div>				
			`
			}
			if(j==9){
			carne.innerHTML +=
			`
				<br2>&nbsp</br2>
				<br2>&nbsp</br2>
				<br2>&nbsp</br2>
			`
			}
			if(j>9){		
			carne.innerHTML +=
			`			
				<div class="box">			
					${j}º&nbspParcela <strong>${dia}/${meses[mes-1]}/${ano}</strong>			
				</div>					
			`
			}
			
		}
		var i = 0;	
		carne.innerHTML +=		
		`
		<p>&nbsp</p>
		<p>&nbsp</p>			

		`	
		if({{object.qtd_parcelas}}==1){
			carne.innerHTML +=		
			`	
			<p class="space1">&nbsp</p>
			`	
		}
		if({{object.qtd_parcelas}}==2){
			carne.innerHTML +=		
			`	
			<p class="space1">&nbsp</p>		
			
			`	
		}
		if({{object.qtd_parcelas}}==3){
			carne.innerHTML +=		
			`	
			<p class="space2">&nbsp</p>	
			`	
		}
		if({{object.qtd_parcelas}}==4){
			carne.innerHTML +=		
			`	
			<p>&nbsp</p>
			<p>&nbsp</p>			
			<p>&nbsp</p>			
			
			`	
		}
		if({{object.qtd_parcelas}}==5){
			carne.innerHTML +=		
			`	
			<p>&nbsp</p>
			<p>&nbsp</p>			
			<p>&nbsp</p>
			
			`	
		}
		if({{object.qtd_parcelas}}==6){
			carne.innerHTML +=		
			`	
			<p>&nbsp</p>	
			
			`	
		}
		if({{object.qtd_parcelas}}==7){
			carne.innerHTML +=		
			`	
			<p>&nbsp</p>			
				
			`	
		}
		if({{object.qtd_parcelas}}==8){
			carne.innerHTML +=		
			`	
			<p>&nbsp</p>		
			
			`	
		}
		if({{object.qtd_parcelas}}==9){
			carne.innerHTML +=		
			`	
			<p class="reducao1">&nbsp</p>	
			
			`	
		}
		if({{object.qtd_parcelas}}==10){
			carne.innerHTML +=		
			`	
			<p class="reducao1">&nbsp</p>	
			
			`	
		}
		if({{object.qtd_parcelas}}==11){
			carne.innerHTML +=		
			`	
			<p class="reducao1">&nbsp</p>	
			
			`	
		}
		if({{object.qtd_parcelas}}==12){
			carne.innerHTML +=		
			`	
			<p class="reducao1">&nbsp</p>	
			
			`	
		}
		carne.innerHTML +=		
			`	
			<p>&nbsp</p>			
			<p>&nbsp</p>
			`	

		//VARIÁVEIS DA DATA DO EMPRESTIMO
		var contador_meses = 0
		var contador_anos  = 0
		var dataEmprestimo = "{{ object.dt_emprestimo}}"		
		var dia
		var mes
		var ano
		var aux_dia = {{object.dt_emprestimo.day}}
		var aux_mes = {{object.dt_emprestimo.month}}
		var aux_ano = {{object.dt_emprestimo.year}}
		
		for (var i = 0 ; i < {{object.qtd_parcelas}}; i++){
			contador_meses++
			contador_parcela++

			dia  = aux_dia			
			mes  = aux_mes+contador_meses
			ano  = aux_ano

			//AJUSTA A DATA QUANDO O MES É FEVEREIRO 
			if(dia == 1 && mes == 4){
                dia = 30 
                mes = 3
            }
			if(dia == 30 && mes == 2){
				dia = 1 
				mes = 3
			}			
			//AJUSTA MESES E ANOS 
			if(mes == 13){
				contador_meses = 0
				aux_mes = 1
				mes = 1	
				aux_ano++
				ano++				
			}
			
			carne.innerHTML +=		
			`	
			<table cellspacing="0" cellpadding="0" border="1">
				<!--1º linha-->
				<tr>
					<td width="15%" >
						<p class="content testando"><b>CREDCOOP</b></p>							
						<p class="content testando">(84) 4141-3210</p>
					</td>
					<td width="1px"></td>
					<td width="39%" colspan="6">
						<p class="content testando"><b>CREDCOOP</b></p>							
						<p class="content testando">(84) 4141-3210</p>						
					</td>						
				</tr>
				<!--2º linha-->
				<tr>					
					<td width="15%">							
						<span class="title">&nbspVencimento</span>							
						<br/>						
						<p class="content right text">&nbsp${dia}/${meses[mes-1]}/${ano}&nbsp</p>	
													
					</td>
					<td width="1px" ></td>
					<td width="70%" colspan="5">
						<p class="content "><b>&nbsp Local de Pagamento: ESCRITÓRIO</b></p>	
						
					</td>
					<td width="45%">
						<span class="title">&nbspVencimento</span>
						<br/>				
						<p class="content right text">&nbsp${dia}/${meses[mes-1]}/${ano}&nbsp</p>
					
					</td>
				</tr>
				<!--3º linha-->
				<tr>
					<td width="15%">
						<span class="title">&nbspValor do Documento</span>
						<br/>
						<p class="content right">&nbspR$ ${"{{object.valor_prestacao}}"}&nbsp</p>
					</td>
					<td width="1px"></td>
					<td width="17%" colspan="5">
						<span class="title">&nbsp Nome do Cedente</span>
						<br/>
						<p class="content left">&nbsp CREDCOOP</p>
					</td>
					<td width="15%">
						<span class="title">&nbspValor do Documento</span>
						<br/>
						<p class="content right">&nbspR$ ${"{{object.valor_prestacao}}"}&nbsp</p>
					</td>
				</tr>
				<!--4º linha-->
				<tr>
					<td width="15%">
						<p class="content left">&nbsp<b>PARCELA: ${i+1}/${aux_qtd_parccela}<b></p>
					</td>
					<td width="1px">
						<span class="title"></span>
						<br/>
						<p class="content center"></p>
					</td>
					<td width="50%" colspan="4">
						<p class="content center"><b>Data de Emissão: </b>${data_emissao}</p>		
					</td>		
					<td>
						<p class="content center"></p>						
						
					</td>
					<td width="30%">
						<p class="content left">&nbsp<b>PARCELA: ${i+1}/${aux_qtd_parccela}<b></p>
					</td>
				</tr>	
				<!--5º linha-->			
				<tr>
					<td width="15%">
						<p class="content left">&nbspDescontos </p>
						<p class="content left">&nbsp </p>	
					</td>
					<td width="1px"></td>
					<td colspan="5" rowspan="4">
						<span class="title2">&nbsp <b>INSTRUÇÕES:<br/><br/>
						&nbsp <b>MULTA DE R$: ${valor_multa} APÓS: ${dia}/${meses[mes-1]}/${ano}<br/>
						&nbsp JUROS DE R$: ${valor_juros_dia} AO DIA<br/></b>
						</span>				
					</td>
					<td width="15%">
						<p class="content left">&nbspDesconto </p>
						<p class="content left">&nbsp </p>
					</td>
				</tr>	
				<!--6º linha-->				
				<tr>
					<td width="15%">
						<p class="content left">&nbspAcréscimos</p>
						<p class="content left">&nbsp </p>
					</td>
					<td width="1px"></td>
					<td width="15%">
						<p class="content left">&nbspAcréscimos  </p>
						<p class="content left">&nbsp </p>
					</td>
				</tr>
				<!--7º linha-->
				<tr>
					<td width="15%">
						<p class="content left">&nbspMora/Multa  </p>
						<p class="content left">&nbsp </p>
					</td>
					<td width="1px"></td>
					<td width="15%">
						<p class="content left">&nbspMora/Multa  </p>	
						<p class="content left">&nbsp </p>
					</td>
				</tr>
				<!--8º linha-->
				<tr>
					<td width="15%">
						<p class="content left">&nbspValor cobrado</p>							
						<p class="content center">&nbsp</p>						
											
					</td>
					<td width="1px"></td>
					<td width="15%">
						<p class="content left">&nbspValor cobrado</p>							
						<p class="content center">&nbsp</p>						
						
					</td>
				</tr>
				<!--9º linha-->
				<tr>
					<td width="15%">
						<p class="content left"><b>&nbspVisto do Operador</b></p>							
						<p class="content center">Pago em:</p>						
						<p class="content left">&nbsp&nbsp&nbsp&nbsp ____/____/____ </p>
					</td>
					<td width="1px"></td>
					<td width="39%" colspan="5">
						<p class="content">&nbspSacado: ${cliente_nome} - CPF: ${cpf} </p>						
						<p class="content">&nbspEndereço: ${rua} - ${numero_casa} - ${bairro} - ${uf} - ${cep}</p>
						<p class="content maiusculo">&nbspFiador: ${fiador} - &nbspCPF: ${cpf_fiador}</p>
					</td>
					<td width="15%">
						<p class="content left"><b>&nbspVisto do Operador</b></p>							
						<p class="content center">Pago em:</p>						
						<p class="content left">&nbsp&nbsp&nbsp&nbsp ____/____/____ </p>
					</td>
				</tr>
			</table>				
			`
			if(i == 1)
			{
				carne.innerHTML +=
				`			
					<p class="reducao" style="page-break-before:always">&nbsp</p>				
									
				`
			}			
			else if(i == 4)
			{
				carne.innerHTML +=
				`			
					<p class="reducao"  style="page-break-after:always">&nbsp</p>				
				`
			}				
			else if(i == 7)
			{
				carne.innerHTML +=
				`			
					<p class="reducao" style="page-break-after:always">&nbsp</p>				
				`
			}			
			else if(i == 10)
			{
				carne.innerHTML +=
				`			
					<p class="reducao" style="page-break-after:always">&nbsp</p>				
				`
			}			
		}
	}	

	</script>
</html>







